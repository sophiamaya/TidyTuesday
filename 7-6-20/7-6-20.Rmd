---
title: "TidyTuesday.7.6.20"
author: "Sophia Foster"
date: "7/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidytuesdayR)
library(tidyverse)
library(ggplot2)
library(sf)
theme_set(
  theme_void()
  )
```

```{r}
tuesdata <- tidytuesdayR::tt_load('2020-07-07')
tuesdata <- tidytuesdayR::tt_load(2020, week = 28)

coffee_ratings <- tuesdata$coffee_ratings
```

```{r}
ratings_tidy <- coffee_ratings %>%
  select(country_of_origin, total_cup_points) %>%
  group_by(country_of_origin) %>%
  summarize(average_rating = mean(total_cup_points)) %>%
  drop_na(country_of_origin) %>%
  mutate(region = country_of_origin)

View(ratings_tidy)
```

```{r}
library(maps)

world_map <- map_data("world")
ggplot(world_map, aes(x = long, y = lat, group = group)) +
  geom_polygon(fill="lightgray", colour = "white")
```

```{r}
world_map <- map_data("world")
rating.map <- left_join(ratings_tidy, world_map, by = "region")

Create the choropleth map. Note that, data are missing for some region in the map below:
Use the function geom_polygon():

ggplot(rating.map, aes(long, lat, group = group))+
  geom_polygon(aes(fill = average_rating ), color = "white")+
  scale_fill_viridis_c(option = "C")

ggplot(rating.map, aes(map_id = region, fill = average_rating))+
  geom_map(map = rating.map,  color = "white")+
  expand_limits(x = rating.map$long, y = rating.map$lat)+
  scale_fill_viridis_c(option = "C")
```

